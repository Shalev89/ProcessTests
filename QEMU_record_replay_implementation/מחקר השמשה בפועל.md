לפי chatGPT, הגרסה הדיפולטיבית של QEMU עבור ubuntu לא תומכת ב-record replay. 
אבל לא בהכרח מאמין לזה.

אני רוצה להתחיל בלהדגים פשוט את ה-record/replay עם image בסיסי של לינוקס, לפני שאני מוסיף קוד שיורץ בתוכו. אז הורדתי את ה-iso של Tiny Core, ויצרתי image.

הפקודה המקורית שיש בתיעוד של qemu:
בשביל הקלטה:
qemu-system-x86_64 \
-icount shift=auto,rr=record,rrfile=replay.bin \
-drive file=disk.qcow2,if=none,snapshot,id=img-direct \
-drive driver=blkreplay,if=none,image=img-direct,id=img-blkreplay \
-device ide-hd,drive=img-blkreplay \
-netdev user,id=net1 -device rtl8139,netdev=net1 \
-object filter-replay,id=replay,netdev=net1
בשביל ניגון replay:
qemu-system-x86_64 \
-icount shift=auto,rr=replay,rrfile=replay.bin \
-drive file=disk.qcow2,if=none,snapshot,id=img-direct \
-drive driver=blkreplay,if=none,image=img-direct,id=img-blkreplay \
-device ide-hd,drive=img-blkreplay \
-netdev user,id=net1 -device rtl8139,netdev=net1 \
-object filter-replay,id=replay,netdev=net1
עכשיו אנסה להבין כיצד להשתמש בזה עם ה-iso וה-image שיש לי.
אני רואה ב-man page שלעשות -drive file=smt ייקח את ה-smt כ-disk image. 
ה-if אומר interface. ה-id מפרט identifier ל-device. 
טוב. אנסה להחליף רק את file בקובץ של ה-image ונראה מה קורה.

הסכים לעלות.
וזה אכן עבד!! כאשר עשיתי replay זה ניגן את הכל מחדש. עכשיו, אני רוצה להדגיש כמה דברים:
1 - צריך שכל הדגלים יהיו **בדיוק** אותו דבר בין ההקלטה לבין הניגון מחדש, למעט שמחליפים את rr מלקבל record ללקבל replay.
2 - את ה-image שרוצים להריץ נותנים ל-drive file=. יכול מאוד להיות שאנחנו בפועל לא נרצה אולי להריץ image אלא משהו אחר, ויש אכן עוד אופציות.
3 - פקודה זו מפרטת למשל רכיב תקשורת אחד (ממה שאני מבין), ולכן תדרוש התאמות רבות
4 - אם משתמשים ב-kvm או ב-xen (שני פתרונות של virtualization), אז לא ניתן להשתמש ב-icount, ולכן לא ניתן להשתמש בפיצ'ר זה.

כרגע קצת חוקר על -drive. זה נראה שזה בגדול בגדול מאחד בין -device לבין -blockdev. 

עוד דבר מעניין - זה נראה שה-replay אינו כזה קטן מבחינת אחסון. 
למשל, עשיתי סימולציה שאורכה 27 שניות, כאשר ה-image שהרצתי הוא של tiny core, והכנסתי מעט מאוד קלטים:
ctrl+b
'help' + enter
'echo hello' + enter
ctrl+alt+g (for stopping recording of inputs) and quitting system
והגודל של ה-replay הוא כבר 868kB.


(אני רואה שגם יש קטע על נגיד איך לעשות שזה יקליט וישחזר דברים של לגשת לדיסק וכאלו, אקרא על זה מאוחר יותר)
(גם אציין שהגרסה הנוכחית של הפקודה היא משתמשת במשהו שהוא deprecated, משהו של snapshot, צריך לתקן את זה)
כעת אני רוצה להבין את עניין כרטיסי הרשת - איך מפרטים נגיד שיהיו כמה דברים.